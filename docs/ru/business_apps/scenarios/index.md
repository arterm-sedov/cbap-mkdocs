---
title: Сценарии
tags:
  - сценарии
  - сценарий
  - триггеры
  - события
  - событие сценария
  - сценарий
  - триггер
  - действия сценария
  - действие сценария
  - элементы сценария
  - шаги сценария
  - проверка сценария
  - удаление сценария
  - очистка сценария
  - свойства сценария
hide:
  - tags
kbId: 2151
---

# Сценарии. Определение, создание, настройка, использование {: #scenarios}

## Введение

Сценарии являются удобным инструментом настройки приложений **{{ productName}}**.

!!! question "Определения"

	**Сценарий** — это алгоритм валидации и обработки данных. Сценарий содержит цепочку из [действий][scenario_actions], которая будет запущена при срабатывании указанного [события][scenario_event].

	Сценарий запускается при наступлении следующих событий:

	- на входе токена в элемент диаграммы процесса;
	- на выходе токена из элемента диаграммы процесса;
	- при запуске процесса;
	- при нажатии кнопки;
	- при создании или изменении записи в целевом шаблоне;
	- при получении сообщения от внешних систем.

Сценарии могут использоваться как часть процессов, так и вне процессов вовсе.

Сценарии имеют ряд своих особенностей, что обуславливает специфику их использования:

- Сценарий выполняется один раз при наступлении начального события.
- Он позволяет переключаться между шаблонами и манипулировать данными в них.
- Один сценарий не может выполняться одновременно для нескольких записей.
- Сценарии не экспортируются при переносе приложения.
- Представляют последовательную цепочку событий, которую нельзя зацикливать.
- Если при выполнении сценария происходит ошибка, то его действия отменяются. Если ошибка сценария произошла в процессе, то он будет остановлен.

Сценарии помогают настроить различные процессы, в том числе:

- создание и изменение записей;
- получение и отправка электронной почты;
- получение и отправка HTTP-запросов;
- организация условного выполнения операций;
- дополнение справочников мета-данными;
- отображение на форме мета-данных из справочника;
- подготовка документов по образцу с заполненными данными;
- принудительная остановка процесса;
- запрет на изменение данных в записях;
- внесение изменений в данные пользователем без учёта роли и разрешений;
- запуск процессов;
- объединение процессов.

### Готовые примеры использования сценариев

- [Отправка эл. почты из сценариев через SMTP и Exchange. Настройка подключения, пути передачи данных и сценария][scenario_send_email]
- [Получение эл. почты из сценариев через SMTP и Exchange. Настройка подключения, пути передачи данных и сценария][imap_receiving_connection]
- [Пример: согласование заявлений по эл. почте. Настройка подключений, путей передачи данных и диаграммы процесса][process_email_configure]
- [Внешняя СУБД (MySQL, MSSQL, Oracle, Postgres). Отправка SQL-запроса SELECT. Настройка подключения, пути передачи данных и сценария][sql_send_connection]
- [Внешняя СУБД (MySQL, MSSQL, Oracle, PostgreSQL). Получение данных по таймеру. Настройка подключения, пути передачи данных и сценария][sql_receive_connection]
- [Отправка HTTP-запросов типа GET. Пример: настройка подключения, пути передачи данных и сценария для обработки запросов в формате JSON][send_http_example]
- [Настройка универсального процесса согласования][business_approval_process]
- [Отправка уведомлений с помощью Telegram. Пример: настройка подключения, пути передачи данных, сценария, приложения и Telegram-бота][telegram_send_notification]
- [Копирование записи вместе с прикреплённым документом. Настройка сценария][attribute_document_clone_scenario]
- [Получение сообщений через Kafka. Настройка подключения, пути передачи данных и сценария][kafka_connection]
- [Шевроны. Визуализация этапов процесса. Пример настройки][chevron_stage_render]
- [Документы с электронной подписью: настройка приложения и использование][document_digital_signature]

## Использование списка сценариев в приложении

1. Откройте страницу [«**Администрирование**» — «**Сценарии**»][administration].
2. Отобразится список сценариев.
3. Выполните требуемые действия со сценариями:

	- **Создать** — нажмите кнопку «**Создать**», чтобы [настроить свойства](#настройка-свойств-сценария) нового сценария и перейти к настройке [его события и действий](#конструктор-сценария).
	- **Настроить свойства** — установите флажок выбора для сценария и нажмите кнопку «**Свойства**», чтобы [настроить свойства](#настройка-свойств-сценария) имеющегося сценария.
    - **Открыть** — дважды нажмите строку сценария, чтобы настроить [его событие и действия](#конструктор-сценария).
	- **Удалить** — установите флажки выбора для сценариев, нажмите кнопку «**Удалить**» и подтвердите удаление.

_![Список сценариев в приложении](scenarios_list.png)_

## Настройка свойств сценария

1. Откройте список сценариев.
2. Нажмите кнопку «**Создать**» или «**Свойства**», выбрав или открыв сценарий.
3. Настройте и сохраните свойства сценария:

   - **Название** — наглядное наименование сценария.
   - **Системное имя** — уникальное имя.
   --8<-- "system_name_requrements.md"

    !!! note "Примечание"

        Для сценариев на входе и выходе из элементов диаграммы процесса название и системное имя сценария формируются автоматически.

   - **Контекст выполнения** — аккаунт, от имени которого должен выполняться сценарий:
       - **От имени системы** — сценарий будет выполняться с полными правами аккаунта «**Система**», без учёта роли и разрешений пользователя, инициировавшего событие, по которому запускается сценарий. То есть сценарий сможет выполнять _любые действия_.
       - **От инициатора** — сценарий будет выполняться при наличии необходимых разрешений у пользователя, инициировавшего событие, по которому выполняется сценарий. В случае отсутствия у пользователя разрешений система выдаст ошибку.
   - **Статус** — состояние сценария:
       - **Активен** — сценарий выполняется при каждом наступлении заданного события.
       - **Приостановлен** — сценарий не выполняется при наступлении заданного события.

4. Если вы создали сценарий, откроется его конструктор. [Настройте сценарий](#конструктор-сценария).

_![Окно свойств нового сценария](scenario_create_properties.png)_

## Настройка события и действий сценария

Для настройки сценария в **{{ productName }}** предусмотрен удобный визуальный конструктор.

Открыть конструктор сценария можно двумя способами:

* Дважды нажмите строку сценария в [списке сценариев](#использование-списка-сценариев-в-приложении).
* Нажмите кнопку «**Сценарий на входе**» или «**Сценарий на выходе**» в меню элемента [диаграммы бизнес-процесса][process_diagram].

	_![Кнопки создания сценария на входе и выходе из элемента диаграммы процесса](scenario_exit_enter_process_element.png)_

В конструкторе сценария предусмотрены следующие кнопки:

1. **Свойства** — настройка [свойств сценария](#scenario_properties).
2. **Очистить** — безвозвратное удаление всех элементов сценария. После нажатия этой кнопки в сценарий будет помещено пустое начальное событие «**Нажатие кнопки**», как если бы сценарий был создан заново.
3. **Удалить** — удаление сценария. Требуется подтверждение.
4. **Проверить** — проверка целостности и работоспособности сценария. При нажатии этой кнопки отобразится панель «**Результат проверки**» с перечнем выявленных ошибок в сценарии. Элементы сценария с ошибкой будут выделены красным цветом.

    _![Конструктор сценария](scenario_designer.png)_

## Настройка элементов сценария

При наведении указателя мыши на элемент сценария и его выборе отображаются кнопки настройки элемента.

- **Название элемента сценария** — нажмите, чтобы перейти к настройкам свойств элемента.
- **Изменить** — нажмите <i class="fa-light  fa-edit"></i>, чтобы перейти к настройкам свойств элемента.
- **Перейти к контекстному шаблону** — нажмите <i class="fa-light  fa-external-link"></i>, чтобы перейти к [шаблону][templates], в контексте которого выполняется элемент сценария.
- **Удалить** — нажмите <i class="fa-light  fa-trash-alt"></i>, чтобы безвозвратно [удалить действие сценария](#удаление-действия). Требуется подтверждение.
- **Добавить действие** — нажмите <i class="fa-light  fa-plus-circle"></i>, чтобы [создать действия](#создание-действия) после текущего элемента или внутри него.

!!! warning "Внимание!"

    При настройке сценария изменения сохраняются и применяются автоматически.

_![Кнопки настройки элемента сценария](scenario_element_buttons.png)_

### Создание действия

!!! note "Примечание"

	Внутрь действий «**Создать запись**», «**Дублировать запись**», «**Сменить контекст**», «**Выполнить по условиям**», «**Повторять по числовому счётчику**», «**Повторять по количеству объектов**» можно поместить другие действия.

1. Наведите указатель мыши на элемент сценария, после или внутрь которого требуется добавить действие.
2. Нажмите кнопку «**Добавить действие**» <i class="fa-light  fa-plus-circle"></i>.
3. Выберите необходимое действие в раскрывающемся меню.
4. В конструкторе сценария появится новое действие.
5. [Настройте действие](#кнопки-настройки-элементов-сценария).

    _![Создание действия в сценарии](scenario_create_action.png)_

--8<-- "related_topics_heading.md"

**[Настройка действий сценария][scenario_actions]**

**[Использование переменных в сценарии][scenario_variables]**

{%
include-markdown ".snippets/hyperlinks_mkdocs_to_kb_map.md"
%}
