---
title: Атрибут типа «Текст». Поиск подстроки с помощью N3
tags:
    - выражение N3
    - тройка
    - тройки
    - N3
    - поиск строки
    - подстрока
hide:
    - tags
kbId: 2628
---

# Атрибут типа «Текст». Поиск строки в тексте с помощью N3 {: attribute_text_substring_search_n3}

## Введение

**[Текстовый атрибут][attribute_text]** может содержать неограниченное количество символов. Поиск определённого слова, словосочетания или предложения в большом объёме текста может быть затруднён. Чтобы быстро проверить наличие искомой строки в тексте, можно использовать выражение на N3.

Здесь представлен пример настройки логического атрибута, который реагирует на наличие определённого слова в тексте, с помощью выражения на N3.

## Прикладная задача

Имеется шаблон _«Заявки»_. Если в комментарии клиент пишет слово _«срочно»_ (и любые варианты этого слова), то такую заявку необходимо отметить флажком _«Срочная заявка»_ с помощью логического атрибута.

## Поиск слова в значении текстового атрибута

1. Создайте шаблон _«Заявки»_ со следующими атрибутами:

    | Название      | Тип данных     | Свойства                                                                        |
    | ------------- | -------------- | ------------------------------------------------------------------------------- |
    | _Комментарий_ | **Текст**      |                                                                                 |
    | _Срочная заявка_     | **Логический** | <p>**Вычислять автоматически:** флажок установлен</p><p>**Вычисляемое выражение: N3**</p> |

2. В атрибуте _«Срочная заявка»_ введите следующее **вычисляемое выражение на N3** :

    ``` turtle
    # Импортируем функции для работы с записями и строками
    @prefix object: <http://comindware.com/ontology/object#>.  
    @prefix cmwstring: <http://comindware.com/logics/string#>.  
    {  
        # Находим атрибут Kommentariy (Комментарий) в шаблоне Zayavki (Заявки)
        # и помещаем его в переменную KommentariyAttribute
        ("Zayavki" "Kommentariy") object:findProperty ?KommentariyAttribute.   
        # Помещаем строку из атрибута «Комментарий»
        # текущей заявки ?item в переменную ?text
        ?item ?KommentariyAttribute ?text.
        # Проверяем, содержит ли переменная ?text строку «срочн»
        # то есть формы слова «срочно» с любыми окончаниями
        ?text cmwstring:contains "срочн".
            # Если строка была найдена в переменной text,
            # то значение вычисляемого атрибута сменится на true
            true -> ?value.  
    }
    ```

    !!! tip "Подсказка"

        Вместо литерала `"срочн"`, искомое слово можно брать из текстового атрибута. Тогда выражение на N3 будет выглядеть следующим образом:
        
        ``` turtle
        @prefix object: <http://comindware.com/ontology/object#>.  
        @prefix cmwstring: <http://comindware.com/logics/string#>.  
        {  
            ("Zayavki" "Kommentariy") object:findProperty ?KommentariyAttribute.   
            ?item ?KommentariyAttribute ?text.
            # Помещаем значеие атрибуат searchWord в переменную ?keyword
            ("Zayavki" "searchWord") object:findProperty ?searchWordAttribute.   
            ?item ?searchWordttribute ?keyword.
            ?text cmwstring:contains ?keyword.
                true -> ?value.  
        }
        ```

    !!! warning "Внимание"

        Такой поиск чувствителен к регистру, и, например, «Срочно» и «срочно» считаются разными строками.

3. Поместите атрибуты на форму и сохраните. У атрибута _«Срочная заявка»_ установите **представление** в виде **флажка**.

## Тестирование

1. Создайте новую заявку.
2. В комментарии укажите любой текст и напишите слово _«срочно»_.
3. В поле _«Срочная заявка»_ будет установлен флажок.
4. Удалите из комментария слово _«срочно»_.
5. В поле _«Срочная заявка»_ флажок будет снят.

--8<-- "related_topics_heading.md"

**[Атрибут типа «Текст»][attribute_text]**

**[Написание выражений на языке N3][manual_n3]**

{%
include-markdown ".snippets/hyperlinks_mkdocs_to_kb_map.md"
%}
