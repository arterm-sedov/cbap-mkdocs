---
title: Атрибут типа «Текст». Поиск строки в тексте с помощью выражения N3
tags:
    - выражение N3
    - тройка
    - тройки
    - N3
    - поиск строки
hide:
    - tags
kbId:
---

# Атрибут типа «Текст». Поиск строки в тексте с помощью выражения N3

## Введение

В **{{ productName }}** можно создавать [текстовые атрибуты][attribute_text] и помещать в них неограниченное число символов. Поиск определённого слова, словосочетания или предложения при большом объёме данных может быть затруднён. Чтобы быстро проверить наличие искомой строки в тексте, можно использовать выражение N3.

Здесь представлен пример настройки логического атрибута, который реагирует на наличие определённого слова в тексте, с помощью выражения N3.

## Прикладная задача

Существует шаблон _«Заявки»_. Если в комментарии клиент пишет слово _«срочно»_, то такую заявку необходимо пометить флажком в логическом атрибуте.

## Поиск определённого слова в текстовом атрибуте

1. В шаблоне _«Заявки»_ добавьте следующие атрибуты:

| Название      | Тип данных     | Свойства                                                                        |
| ------------- | -------------- | ------------------------------------------------------------------------------- |
| _Комментарий_ | **Текст**      |                                                                                 |
| _Срочно?_     | **Логический** | <p>**Вычислять автоматически:** флажок установлен</p><p>**Вычисляемое выражение: N3**</p> |

2. Добавьте следующее выражение N3:

    ``` turtle
    # Импортируем функции для работы с записями и строками
    @prefix object: <http://comindware.com/ontology/object#>.  
    @prefix cmwstring: <http://comindware.com/logics/string#>.  
    {  
        # Находим атрибут Kommentariy («Комментарий») в шаблоне Zayavki («Заявки»)
        # и помещаем его в переменную tekstAttribute
        ("Zayavki" "Kommentariy") object:findProperty ?tekstAttribute.   
        # Помещаем строку из атрибута «Комментарий»
        # из текущей заявки item в переменную tekst
        ?item ?tekstAttribute ?tekst.
        # Проверяем, содержит ли переменная tekst строку «срочно»
        ?tekst cmwstring:contains "срочно".
        # Если строка была найдена в переменной tekst,
        # то значение вычисляемого атрибута сменится на true
        true -> ?value.  
    }
    ```

!!! warning "Внимание"

    Такой поиск чувствителен к регистру, и, например, «Срочно» и «срочно» считаются разными строками.

3. Вынесите атрибуты на форму и сохраните. У атрибута _«Срочно?»_ оставьте отображение в виде флажка.

## Тестирование

1. Создайте новую заявку.
2. В комментарии укажите любой текст и напишите слово _«срочно»_.
3. В поле атрибута _«Срочно?»_ будет установлен флажок.
4. Удалите из комментария слово _«срочно»_.
5. В поле атрибута _«Срочно?»_ флажок будет снят.

--8<-- "related_topics_heading.md"

**[Атрибут типа «Текст»][attribute_text]**

**[Написание выражений на языке N3][manual_n3]**

{%
include-markdown ".snippets/hyperlinks_mkdocs_to_kb_map.md"
%}
