---
title: Сценарий. Запрет сохранения записи
tags: 
    - проверить результат выражения
    - сценарий
    - валидация данных
hide: tags
kbid: 2637
---

# Сценарий. Проверка данных записи перед сохранением {: #scenario_verify_data}

Для проверки данных перед сохранением записи обычно используется действие «**Показать ошибку**» в правилах для формы. Однако с помощью этого действия может быть затруднительно реализовать сложную логику проверки, либо проверочное выражение будет неудобочитаемым. К тому же чрезмерно сложные правила для формы могут замедлять ввод данных в форму.

В таких случаях для проверки данных перед сохранением записи можно использовать действие «[**Проверить результат выражения**][scenario_actions_validate_expression]» в сценарии по событию «**Создание записи**», «**Изменение записи**» или «**Нажата кнопка**». Сценарий позволяет наглядно реализовать логику проверки данных произвольной сложности. Кроме того, сценарий срабатывает только при сохранении записи, благодаря чему повышается производительность.

## Практический пример

Настроим сценарий, который будет запрещать сохранение заявки на поездку, если не указана её длительность.

### Исходные данные

В шаблоне _«Заявки»_ имеется атрибут _«Длительность поездки»_ (`TripDuration`) типа «**Число**», этот атрибут вынесен на форму заявки.

## Настройка сценария

1. Создайте сценарий.
2. В начальном событии «**Нажата кнопка**» выберите контекстный шаблон _«Заявки»_ и кнопку «**Сохранить**».
3. Добавьте действие:
   - **Проверить результат выражения**
      - **Сообщение об ошибке:** _Длительность поездки не может быть нулевой_
      - **Выражение: формула**

          ``` cs
          // Введите выражение, которое будет возвращать
          // false, когда сохранение записи запрещено, и
          // true, когда сохранение записи разрешено.
          GREATER($TripDuration,0)
          ```

### Тестирование сценария

1. Создайте заявку и не заполняйте поле _«Длительность поездки»_.
2. Нажмите кнопку «**Сохранить**».
3. На экране отобразится сообщение _«Длительность поездки не может быть нулевой»_.
4. Заполните поле _«Длительность поездки»_ и нажмите кнопку «**Сохранить**».
5. Отобразится сообщение об успешном сохранении записи.

--8<-- "related_topics_heading.md"

**[Событие и действия сценария. Определения, типы, свойства, настройка][scenario_elements]**

**[Отладка формул, выражений N3, сценариев и C#-скриптов][expression_debug]**

{%
include-markdown ".snippets/hyperlinks_mkdocs_to_kb_map.md"
%}
