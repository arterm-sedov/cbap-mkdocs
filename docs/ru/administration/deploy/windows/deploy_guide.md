---
title: Установка, запуск, инициализация и остановка ПО
kbId:
---

# Установка, запуск, инициализация и остановка ПО {: #deploy_guide_windows}

## Введение

Для работы **{{ productName }}** требуются операционная система, сервер базы данных, веб-сервер, обратный прокси-сервер и сервер журналов.

Для быстрого развертывания **{{ productName }}** в среде Windows компания **{{ companyName }}** предоставляет дистрибутив с установщиком, настраивающим необходимое программное обеспечение.

Здесь представлены инструкции по развертыванию и инициализации **{{ productName }}** из дистрибутива в операционных системах Windows.

## Установка {{ productName }} {: #deploy_guide_windows_install_sw}

1. Распакуйте архив с дистрибутивом.
2. Запустите _PowerShell_ от имени администратора.
3. Установите неограниченную политику выполнения _PowerShell_:

    ``` sh
    Set-ExecutionPolicy Unrestricted
    ```

4. В запросе на изменение политики выберите вариант «Да для всех», введя букву ++a++.
5. Перейдите в папку со скриптами для развёртывания ПО:

    ``` sh
    cd "X:\<path>\X.X-release-ru-X.X.XXXX.X.windows\CMW_Windows\scripts\platform"
    ```

    Здесь: `X:\<path>\X.X-release-ru-X.X.XXXX.X.windows` — путь к распакованному дистрибутиву продукта, а `X.X.XXXX.X` — номер версии ПО.

6. Разблокируйте доступ к установочным файлам:

    ``` sh
    .\files_unblock.ps1
    ```

    !!! tip "Вызов справки для скриптов"

        Для ознакомления с ключами и назначением любого скрипта используйте ключ `-h` без каких-либо ключей, например:

        ``` sh
        .\files_unblock.ps1 -h
        ```

7. Перейдите в папку со скриптами для развёртывания вспомогательного ПО:

    ``` sh
    cd "X:\<path>\X.X-release-ru-X.X.XXXX.X.windows\CMW_Windows\scripts\prerequisites"
    ```

8. Установите необходимое вспомогательное ПО:

    ``` sh
    .\prerequisites_install.ps1
    ```

9. Перезагрузите машину.
10. Запустите _PowerShell_ от имени администратора.
11. Перейдите в папку со скриптами для развёртывания вспомогательного ПО:

    ``` sh
    cd "X:\<path>\X.X-release-ru-X.X.XXXX.X.windows\CMW_Windows\scripts\prerequisites"
    ```

12. Проверьте, что дополнительные компоненты установились:

    ``` sh
    .\prerequisites_list.ps1
    ```

    Если какие-либо дополнительные компоненты не установились, повторите п. 8–12.

13. Перейдите в папку со скриптами для развёртывания ПО:

    ``` sh
    cd "X:\<path>\X.X-release-ru-X.X.XXXX.X.windows\CMW_Windows\scripts\platform"
    ```

14. Установите ПО:

    ``` sh
    .\version_install.ps1
    ```

15. Проверьте, что ПО установилась:

    ``` sh
    .\version_list.ps1
    ```

16. Отобразится список установленных версий ПО.

## Установка экземпляра ПО

Установите экземпляр ПО:

``` sh
.\instance_create.ps1 -name <instanceName> -port <portNumber> -version <versionNumber> 
```

Скрипт `instance_create.ps1` поддерживает следующие ключи:

- `-name <instanceName>` — создать экземпляр ПО с указанным именем (**обязательный** ключ).
- `-port <portNumber>` — создать экземпляр ПО с указанным портом (необязательный ключ). Порт по умолчанию: 80.
- `-version <versionNumber>` — развернуть ПО указанной версии вида `X.X.XXXX.X` (например: `5.0.1234.0`) из папки вида `C:\Program Files\Comindware\CBAP\<versionNumber>`.
- `-versionPath <versionPath>` — развернуть ПО из указанной папки `<versionPath>` с версией ПО.
- `-demoDB` — создать экземпляр ПО **{{ productName }}** c демонстрационной базой данных.
- `-fqdn <hostName>` — развернуть экземпляр ПО с указанным именем хоста (необязательный ключ). По умолчанию: `localhost`.
- `-h` — вызвать краткую справку по использованию скрипта (этот ключ следует указывать только без остальных ключей).

## Инициализация {{ productName }}

{%
include-markdown "../linux/deploy_guide.md"
start="<!--initializate-start-->"
end="<!--initializate-end-->"
%}

## Обновление экземпляра ПО

1. Скачайте и установите ПО новой версии согласно инструкциям в параграфе «[Установка {{ productName }}](#deploy_guide_windows_install_sw)».
2. Перейдите в папку со скриптами для развёртывания ПО:

    ``` sh
    cd "X:\<path>\X.X-release-ru-X.X.XXXX.X.windows\CMW_Windows\scripts\platform"
    ```

3. Запустите обновление экземпляра ПО:

    ``` sh
    .\instance_upgrade.ps1 -name <instanceName> -version <versionNumber> 
    ```

    Скрипт `instance_upgrade.ps1` поддерживает следующие ключи:

    - `-name <instanceName>` — обновить до новой версии ПО экземпляр с указанным именем (**обязательный** ключ).
    - `-version <versionNumber>` — обновить экземпляр ПО до указанной версии вида `X.X.XXXX.X` (например: `5.0.1234.0`) из папки вида `C:\Program Files\Comindware\CBAP\<versionNumber>`.
    - `-versionPath <versionPath>` — обновить экземпляр ПО до версии из указанной папки `<versionPath>`.
    - `-h` — вызвать краткую справку по использованию скрипта (этот ключ следует указывать только без остальных ключей).

4. Просмотрите список установленных экземпляров ПО:

    ``` sh
    .\instance_list.ps1
    ```

5. Рядом с именем экземпляра ПО отобразится номер версии.

## Удаление экземпляра ПО

1. Перейдите в папку со скриптами для развёртывания ПО:

    ``` sh
    cd "X:\<path>\X.X-release-ru-X.X.XXXX.X.windows\CMW_Windows\scripts\platform"
    ```

2. Удалите экземпляр ПО:

    ``` sh
    .\instance_delete.ps1 -name <instanceName>
    ```

    Скрипт `instance_delete.ps1` поддерживает следующие ключи:

    - `name <instanceName>` — удалить экземпляр ПО с указанным именем (**обязательный** ключ). Если не указать другие ключи  
    - `deleteData` — удалить базу данных экземпляра ПО.
    - `clear` - удалить все файлы, папки и объекты экземпляра ПО.

## Удаление версии ПО

1. Перейдите в папку со скриптами для развёртывания ПО:

    ``` sh
    cd "X:\<path>\X.X-release-ru-X.X.XXXX.X.windows\CMW_Windows\scripts\platform"
    ```

2. Просмотрите список установленных экземпляров ПО:

    ``` sh
    .\instance_list.ps1
    ```

3. Удалите или обновите все экземпляры с версией ПО, которую требуется удалить.
4. Удалите версию ПО:

    ``` sh
    .\version_delete.ps1 -version <versionNumber>
    ```

    Здесь: `<versionNumber>` — номер версии ПО вида `X.X.XXXX.X` (например: `5.0.1234.0`).

{%
include-markdown ".snippets/hyperlinks_mkdocs_to_kb_map.md"
%}
