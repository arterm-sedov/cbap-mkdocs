---
title: Отправка документов через «СФЕРА Курьер»
kbId:
tags:
hide: tags
---

# Отправка документов через «СФЕРА Курьер». Настройка подключения, пути передачи данных и сценария

## Введение

## Порядок настройки

## Настройка подключения

1. Откройте страницу «**Администрирование**» — «**Подключения**».
2. Откройте двойным нажатием в списке или создайте подключение типа «**Пользовательские подключения**» — «**Отправка сообщений в систему «СФЕРА Курьер**».
3. Настройте свойства подключения:

   - **Системное имя** — введите уникальное имя подключения. Рекомендуется использовать буквы латинского алфавита, цифры и символ «_».
   - **Отключить** — установите этот флажок, если требуется временно деактивировать данное подключение.
   - **Описание** — введите наглядное описание подключения, например _«Подключение для отправки сообщений в систему «СФЕРА Курьер»_.
   - **Запись в файловые журналы** — выберите, какие события следует записывать в журналы:
        - **Полные сведения об обработке сообщения**;
        - **Только ошибки**;
        - **Отключить** — не регистрировать в журнале события отправки сообщений.
   - **Тестовый сервер**
   - **Интервал запроса данных, в минутах** — укажите интервал запроса???
   - **ApiKey** — введите ключ API для подключения к «СФЕРА Курьер».
   - **Имя пользователя** — укажите учетную запись для подключения к «СФЕРА Курьер».
   - **Пароль** — введите пароль для подключения к «СФЕРА Курьер».
   - **Идентификатор участника ЭДО получателя документа** — укажите идентификатор, присвоенный участнику «СФЕРА Курьер».

4. Нажмите кнопку «**Проверить соединение**».
5. Чтобы просмотреть журнал событий отправки сообщений, нажмите кнопку «**Скачать журнал**».
6. Сохраните подключение.

## Настройка пути передачи данных

1. Откройте страницу «**Администрирование**» — «**Пути передачи данных**».
2. Откройте двойным нажатием в списке или создайте подключение типа «**Пользовательские подключения**» — «**Отправка сообщений в «СФЕРА Курьер**».
3. Настройте свойства пути передачи данных на следующих вкладках:

    - [**Основные свойства**](#основные-свойства)
    - [**Атрибуты сообщения**](#атрибуты-сообщения)
    - [**Интеграция**](#интеграция)

4. Сохраните путь передачи данных.

### Основные свойства

На вкладке «**Основные свойства**» настройте параметры использования пути передачи данных.

- **Подключение** — выберите [подключение для отправки сообщений в систему «СФЕРА Курьер»](#настройка-подключения).
- **Системное имя** — введите уникальное имя пути передачи данных. Рекомендуются буквы латинского алфавита, цифры и символ «_».
- **Отключить** — установите этот флажок, если требуется временно деактивировать данный путь передачи данных.
- **Описание** — введите наглядное описание пути передачи данных, например _«Путь для отправки сообщений в «СФЕРА Курьер»_.
- **Номер шины данных** — выберите номер от 0 до 3, если требуется распределить потоки данных нескольких путей для повышения производительности.

### Атрибуты сообщений

На вкладке «**Атрибуты сообщения**» настройте атрибуты, значения которых будут подставляться в содержимое сообщений в зависимости от его типа.

Имеются следующие **типы сообщений**:

- Добавить новый документ;
- Отправить подпись для документа;
- Получить документ;
- Поиск документов;
- Изменение стадий документооборота;
- Отклонить документ;
- Зачитывает данные об организации.

Значения атрибутов сообщения необходимо присвоить с помощью [сценария](#настройка-сценария).

В таблицах «**Запрос**», «**Ответ**» и «**Ответ с ошибкой**» содержатся готовые атрибуты для разных типов сообщения.

#### Атрибуты сообщения типа «Добавить новый документ»

В таблице «**Запрос**» имеются готовые атрибуты сообщения:

- ReceiverCode — идентификатор участника ЭДО получателя документа.
- Comment — комментарий к документу.
- Number — номер документа.
- Date — дата документа.
- RequestSign — признак необходимости запроса подписи у получателя.
- ExistRouteSigner — признак, указывающий на отсутствие в маршруте подписанта на стороне получателя при need_rcpt_sign=1.
- NetSum — сумма без НДС.
- VatSum — сумма НДС.
- TotalSum — сумма с НДС.
- TypeCode — код типа документа.
- Relation — тип взаимосвязи документа.
- ParentDocumentId — идентификатор родительского документа.
- Attachments — приложения к документу.
   - Filename
   - MimeType
   - Content
- Attributes — список атрибутов документа.
   - Key
   - Value
- Barcode — штрихкод документа.
   - Type — Korus.Eds.Core.BarcodeType.
   - Value
- Content — содержимое файла.
   - Filename
   - MimeType
   - Content
- Contract — описание договора.
   - Number
   - Date
- Signature — подпись под документом.
   - Uuid
   - SignerCode
   - Content
- Properties — список дополнительных свойств (параметров) документа.
   - Key
   - Value

В таблице «**Ответ**» имеется готовый атрибут сообщения:

- DocumentId — идентификатор документа.

В таблице «**Ответ с ошибкой**» имеется готовый атрибут сообщения:

- ErrorMessage — описание документа.

#### Атрибуты сообщения типа «Отправить подпись для документа»

В таблице «**Запрос**» имеются готовые атрибуты сообщения:

- DocumentId — идентификатор документа.
- TicketType — тип дополнительной квитанции.
- Ticket — содержимое дополнительной квитанции.
   - Signature
   - Filename
   - MimeType
   - Content
- Uuid — универсальный идентификатор подписи.
- SignerCode — идентификатор участника ЭДО сформировавшего подпись.
- Content — содержимое контейнера с подписью.

В таблице «**Ответ**» имеется готовый атрибут сообщения:

- DocumentId — идентификатор документа.

В таблице «**Ответ с ошибкой**» имеется готовый атрибут сообщения:

- ErrorMessage — описание документа.

#### Атрибуты сообщения типа «Получить документ»

В таблице «**Запрос**» имеется готовый атрибут сообщения:

- DocumentId — идентификатор документа.

В таблице «**Ответ**» имеются готовые атрибуты сообщения:

- DocumentId — идентификатор документа.
- FileName — имя файла.
- Content — содержимое файла.
   - Filename
   - MimeType
   - Content
- SignerLogins — подписанты.
- DocumentStatus — статус.
- ContractNumber — номер договора.
- ContractDate — дата договора.
- Type — тип транспортного документа.
- FormType — типы документов.
- SellerCode — идентификатор участника ЭДО отправителя.
- BuyerCode — идентификатор участника ЭДО получателя.
- FormatVersion — версия формата документа.
- FormatCode — код формата документа.
- RevokeReason — причина отзыва.
- Comment — комментарий к документу.
- ContractDescription — описание договора.
- IsPrintable — признак того, что документ можно распечатать.
- Relations — связанные документы.
   - Id
   - ParentId
   - Relation
   - Description
- StatusName — наименование статуса документа (для текущего пользователя).
- RejectReason — причина отклонения.
- SenderName — наименование отправителя документа.
- ReceiverName — наименование получателя документа.
- ExistRouteSigner — признак, указывающий на отсутствие в маршруте подписанта на стороне получателя при need_rcpt_sign=1.
- DocumentRelationType — статус или тип связи документа.
- Attachments — приложения к документу.
   - Id
   - Uuid
   - DocumentId
   - Filename
   - MimeType
   - Content
- IsRoaming — признак, указывающий, что документ, передавался (должен передаться) в роуминге.
- IsDocflowCompleted — признак завершённости документооборота.
- ReceiveDate — дата получения документа.
- SendDate — дата отправки (выставления) документа.
- Id — идентификатор документа.
- TypeId — идентификатор типа документа.
- TypeName — наименование типа документа.
- DocumentTypeCode — код типа документа.
- Description — описание документа.
- BarcodeType — тип штрихкода.
- BarcodeValue — значение штрихкода.
- SenderId — идентификатор отправителя.
- ReceiverId — идентификатор получателя.
- StatusChanged — дата сменя статуса.
- ParticipantId — идентификатор контрагента (отправителя или получателя).
- Status — статус документа.
- Date — дата документа.
- RequestSign — признак необходимости запроса подписи у получателя.
- Number — номер документа.
- NetSum — сумма без НДС.
- VatSum — сумма НДС.
- TotalSum — сумма с НДС.
- Actions — маска доступных действий с документом.
- IsMarked — признак того, что документ добавлен в избранное.
- Created — дата создания документа.
- ParticipantName — наименование контрагента (отправителя или получателя) документа
- PackageId — идентификатор пакета.
- Signatures — подпись.
   - UserInfo
   - Image
   - Signed
   - Uuid
   - SignerCode
   - Content

В таблице «**Ответ с ошибкой**» имеется готовый атрибут сообщения:

- ErrorMessage — описание документа.

#### Атрибуты сообщения типа «Поиск документов»

В таблице «**Запрос**» имеются готовые атрибуты сообщения:

- Folder — папка документов
- ParticipantId — идентификатор контрагента (отправителя или получателя).
- StatusId — идентификатор статуса.
- From — дата документа с.
- To — дата документа по.
- CreatedFrom — дата создания документа с.
- CreatedTo — дата создания документа по.
- ContractNumber — номер договора.
- ContractDateFrom — дата договора.
- ContractDateTo — дата окончания договора.
- SendDateFrom — начало периода даты отправки (выставления).
- SendDateTo — начало периода даты получения.
- ReceiveDateFrom — начало периода даты получения.
- ReceiveDateTo — окончание периода даты получения.
- IsDocflowCompleted — признак завершённости документооборота.
- IsMine — признак того, что документ назначен текущему пользователю.
- UserId — идентификатор участника маршрута.
- RoleId — идентификатор группы участников маршрута.
- DocumentTypeCode — код типа документа.
- FileName — имя файла.
- Attributes — список атрибутов документа.
   - Key
   - Value
- Skip — параметры постраничной выборки данных.
- Take — количество строк.

В таблице «**Ответ**» имеется готовый атрибут сообщения:

- Documents — идентификатор документов.

В таблице «**Ответ с ошибкой**» имеется готовый атрибут сообщения:

- ErrorMessage — описание документа.

#### Атрибуты сообщения типа «Изменение стадий документооборота»

В таблице «**Запрос**» имеются готовые атрибуты сообщения:

- DocumentId — идентификатор документа.
- Participant — тип подписанта.
- DocumentStages — стадии документооборота.
   - Id — идентификатор документа.
   - Number — номер этапа в маршруте.
   - RoleId — идентификатор группы.
   - IsMandatory — признак обязательной подписи.
   - UserId — идентификатор пользователя.
   - UserName — имя пользователя.
   - Period — срок подписания в рабочих днях.
   - CertificateEnd — дата окончания действия активного сертификата пользователя.

В таблице «**Ответ**» имеются готовые атрибуты сообщения:

- DocumentId — идентификатор документа.
- FileName — имя файла.
- Content — содержимое файла
   - Filename
   - MimeType
   - Content
- SignerLogins — подписанты.
- DocumentStatus — статус.
- ContractNumber — номер договора.
- ContractDate — дата договора.
- Type — тип транспортного документа.
- FormType — типы документов.
- SellerCode — идентификатор участника ЭДО отправителя.
- BuyerCode — идентификатор участника ЭДО получателя.
- FormatVersion — версия формата документа.
- FormatCode — код формата документа.
- RevokeReason — причина отзыва.
- Comment — комментарий к документу.
- ContractDescription — описание договора.
- IsPrintable — признак того, что документ можно распечатать.
- Relations — связанные документы.
   - Id
   - ParentId
   - Relation
   - Description
- StatusName — наименование статуса документа (для текущего пользователя).
- RejectReason — причина отклонения.
- SenderName — наименование отправителя документа.
- ReceiverName — наименование получателя документа.
- ExistRouteSigner — признак, указывающий отсутствие в маршруте подписанта на стороне получателя при need_rcpt_sign=1.
- DocumentRelationType — статус или тип связи документа.
- Attachments — приложения к документу.
   - Id
   - Uuid
   - DocumentId
   - Filename
   - MimeType
   - Content
- IsRoaming — признак, указывающий, что документ, передавался (должен передаться) в роуминге.
- IsDocflowCompleted — признак завершенности документооборота.
- ReceiveDate — дата получения документа.
- SendDate — дата отправки (выставления) документа.
- Id — идентификатор.
- TypeId — 	идентификатор типа документа.
- TypeName — наименование типа документа.
- DocumentTypeCode — код типа документа.
- Description — описание документа.
- BarcodeType — тип штрихкода.
- BarcodeValue — значение штрихкода.
- SenderId — идентификатор отправителя.
- ReceiverId — идентификатор получателя.
- StatusChanged — дата смены статуса.
- ParticipantId — идентификатор контрагента (отправителя или получателя).
- Status — статус документа.
- Date — дата документа. 

## Настройка сценария