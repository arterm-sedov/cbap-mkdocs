<h1>Пример настройки и использования шаблона экспорта авансового отчёта</h1><div class="md-container">
<div class="md-main__inner md-grid">
<div class="mce-toc">
<h2 class="toc-heading">Содержание</h2>
<ul>
<li><a href="#mcetoc_1h1p7o3390">Инструкции</a></li>
<li><a href="#mcetoc_1h1p7o3391">Связанные статьи</a></li>
</ul>
</div>
<div class="md-content">
<h2 id="mcetoc_1h1p7o3390">Инструкции</h2>
<ol class="colored_numbers_list">
<li>
<p>Создайте три <strong><a href="https://kb.comindware.ru/article.php?id=2221">шаблона записи</a></strong>:</p>
<ul>
<li><em>Заявки</em></li>
<li><em>Затраты</em></li>
<li><em>Тип затрат</em></li>
</ul>
</li>
<li>
<p>В шаблоне <em>«Заявки»</em> создайте атрибуты:</p>
<ul>
<li><em>Номер заявки</em>
<ul>
<li><strong>Системное имя</strong>: <code>Nomerzayavki</code></li>
<li><strong>Тип данных</strong>: <strong>текст</strong></li>
</ul>
</li>
<li><em>Время подачи</em>
<ul>
<li><strong>Системное имя</strong>: <code>Datapodachi</code></li>
<li><strong>Тип данных</strong>: <strong>дата и время</strong></li>
</ul>
</li>
<li><em>Затраты</em>
<ul>
<li><strong>Системное имя</strong>: <code>Zatraty</code></li>
<li><strong>Тип данных</strong>: <strong>запись</strong></li>
<li><strong>Связанный шаблон</strong>: <em>Затраты</em></li>
<li><strong>Хранить несколько значений</strong>: флажок установлен</li>
</ul>
</li>
<li><em>Итоговая сумма затрат</em>
<ul>
<li><strong>Системное имя</strong>: <code>Itogovayasummazatrat</code></li>
<li><strong>Тип данных</strong>: <strong>число</strong></li>
</ul>
</li>
</ul>
</li>
<li>
<p>В шаблоне <em>«Затраты»</em> создайте атрибуты:</p>
<ul>
<li><em>Тип затрат</em>
<ul>
<li><strong>Системное имя</strong>: <code>Tipzatrat</code></li>
<li><strong>Тип данных</strong>: <strong>запись</strong></li>
<li><strong>Связанный шаблон</strong>: <em>Тип затрат</em></li>
</ul>
</li>
<li><em>Сумма</em>
<ul>
<li><strong>Системное имя</strong>: <code>Summa</code></li>
<li><strong>Тип данных</strong>: <strong>число</strong></li>
</ul>
</li>
</ul>
</li>
<li>
<p>В шаблоне <em>«Тип затрат»</em> создайте атрибуты:</p>
<ul>
<li><em>Название</em>
<ul>
<li><strong>Системное имя</strong>: <code>Nazvanie</code></li>
<li><strong>Тип данных</strong>: <strong>текст</strong></li>
</ul>
</li>
</ul>
</li>
<li>
<p>Вынесите созданные атрибуты на формы в шаблонах.</p>
</li>
<li>Создайте несколько наглядных записей:
<ul>
<li>справочник типов затрат;</li>
<li>затраты с указанием их типа;</li>
<li>заявки с указанием затрат.</li>
</ul>
</li>
<li>
<p>Создайте файл шаблона экспорта <code>advance_report.xlsx</code>, показанный на иллюстрации:</p>
<div class="screenshot_with_caption"><a class="glightbox" href="https://kb.comindware.ru/assets/export_template_file_example_advance_report.png"><img alt="Файл шаблона экспорта «Авансовый отчёт»" src="https://kb.comindware.ru/assets/export_template_file_example_advance_report.png"/></a>
<p class="caption">Файл шаблона экспорта «Авансовый отчёт»</p>
</div>
</li>
<li>
<p>Создайте в шаблоне записи «<em>Заявки</em>» <a href="https://kb.comindware.ru/article.php?id=2349">шаблон экспорта</a> « <em>Авансовый отчёт</em>» с файлом <code>advance_report.xslx</code>.</p>
</li>
<li>
<p>Вместе с шаблоном экспорта будет автоматически создана <a href="https://kb.comindware.ru/article.php?id=2348">кнопка экспорта записи</a> « <em>Авансовый отчёт</em>».</p>
</li>
<li>
<p>Вынесите кнопку «<em>Авансовый отчёт</em>» на форму шаблона записи «<em>Заявки</em>».</p>
</li>
<li>
<p>Откройте любую запись шаблона «<em>Заявки</em>».</p>
</li>
<li>
<p>Нажмите кнопку «<em>Авансовый отчёт</em>».</p>
</li>
<li>
<p>Браузер скачает файл следующего вида (с именем, заданным в <a href="https://kb.comindware.ru/article.php?id=2349#export-template-output-filename">свойствах шаблона экспорта</a>):</p>
<div class="screenshot_with_caption"><a class="glightbox" href="https://kb.comindware.ru/assets/export_template_file_result.png"><img alt="Файл, сформированный по шаблону экспорта" src="https://kb.comindware.ru/assets/export_template_file_result.png"/></a>
<p class="caption">Файл, сформированный по шаблону экспорта</p>
</div>
</li>
</ol>
<h2 id="mcetoc_1h1p7o3391">Связанные статьи</h2>
<p><strong><a href="https://kb.comindware.ru/article.php?id=1942">Настройка шаблона экспорта с использованием C#</a></strong></p>
<p><strong><a href="https://kb.comindware.ru/article.php?id=1944">Настройка выгрузки нескольких коллекций и изображений</a></strong></p>
<p><strong><a href="https://kb.comindware.ru/article.php?id=2349">Настройка шаблона экспорта</a></strong></p>
<p><strong><a href="https://kb.comindware.ru/article.php?id=2352">Подготовка файла шаблона экспорта</a></strong></p>
<p><strong><a href="https://kb.comindware.ru/article.php?id=2348">Настройка кнопки экспорта</a></strong></p>
</div>
</div>
<p><a class="md-top md-icon mkdocs_imported_link" href="#"> <em class="fa-light fa-arrow-up">‌</em> К началу </a></p>
</div>
<div class="md-dialog">
<div class="md-dialog__inner md-typeset"> </div>
</div>