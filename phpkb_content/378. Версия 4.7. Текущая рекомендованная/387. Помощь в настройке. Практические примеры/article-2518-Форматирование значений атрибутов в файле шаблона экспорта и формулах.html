<h1>Форматирование значений атрибутов в файле шаблона экспорта и формулах</h1><div class="mce-toc">
<h2 class="toc-heading">Содержание</h2>
<ul>
<li><a href="#mcetoc_1hhh1h9c50">Введение</a></li>
<li><a href="#mcetoc_1hhh1i1a51">Форматирование чисел</a></li>
<li><a href="#mcetoc_1hhh1ic4f2">Форматирование дат и времени</a>
<ul>
<li><a href="#mcetoc_1hhha06mh1">Примеры форматирования дат и времени</a></li>
<li><a href="#mcetoc_1hhha0vfg2">Символы форматирования</a></li>
</ul>
</li>
<li><a href="#mcetoc_1hhh1k4kd3">Форматирование значений длительности</a>
<ul>
<li><a href="#mcetoc_1hhhac5793">Примеры форматирования значений длительности</a></li>
<li><a href="#mcetoc_1hhh9f21g0">Символы форматирования</a></li>
</ul>
</li>
<li><a href="#mcetoc_1hhh1kfe44">Форматирование логических значений</a></li>
<li><a href="#mcetoc_1hhh1u2qs5">Форматирование данных аккаунта</a></li>
<li><a href="#mcetoc_1hhh23qoc6">Форматирование атрибутов связанных записей</a></li>
<li><a href="#mcetoc_1hhh24one7">Форматирование значений при экспорте коллекции записей</a>
<ul>
<li><a href="#mcetoc_1hhhtg5pr1">Пример таблицы для экспорта коллекции</a></li>
<li><a href="#mcetoc_1hhh3li6fa">Синтаксис экспорта атрибутов коллекции</a></li>
</ul>
</li>
<li><a href="#mcetoc_1hhh2m6ns8">Связанные статьи</a></li>
</ul>
</div>
<h2 id="mcetoc_1hhh1h9c50">Введение</h2>
<p>В <strong>Comindware Business Application Platform</strong> предусмотрена возможность выгрузки данных записи в шаблон Word, Excel или PDF. Cм. «<samp data-name="aid" data-title="" data-value="2352"><span style="color: #0066bc; font-family: Tahoma;"><img src="https://kb.comindware.ru/images/marker.png" style="vertical-align: middle;"/>Подготовка файла шаблона экспорта {Article-ID:2352}</span></samp>».</p>
<p>В файле шаблона экспорта используются заполнители в фигурных скобках вида <code>{attributeSystemName}</code>, где <code>attributeSystemName</code> — системное имя атрибута.</p>
<p>Для некоторых типов атрибутов можно задать формат значения. Для этого после имени атрибута через двоеточие следует указать формат, в указанной ниже нотации.</p>
<p>Аналогичным образом можно форматировать значения при использовании функций <code>FORMAT()</code> и <code>FORMATLOC()</code>.</p>
<p><code></code></p>
<h2 id="mcetoc_1hhh1i1a51">Форматирование чисел</h2>
<p>Значение атрибута типа «<strong>Число</strong>» экспортируется в документ Word как текст.</p>
<p>Для экспорта в шаблон Excel необходимо в файле Excel настроить соответствующий тип ячейки.</p>
<p>Для атрибута типа «<strong>Число</strong>» можно задать количество знаков после запятой:</p>
<ul>
<li><code>{numberAttributeSystemName:N2}</code> — десятичное число с 2 знаками после запятой;</li>
<li><code>{numberAttributeSystemName:N1}</code> — десятичное число с 1 знаком после запятой;</li>
<li><code>{numberAttributeSystemName:N0}</code> — целое число.</li>
</ul>
<div class="notice notice-info">
<p class="admonition-title">Примечание</p>
<p>Аналогичным образом можно форматировать числа при использовании функции <code>FORMAT()</code>, например:</p>
<pre><code>FORMAT("{0:N2}",LIST($numberAttributeSystemName))</code></pre>
</div>
<h2 id="mcetoc_1hhh1ic4f2">Форматирование дат и времени</h2>
<p>Значение атрибута типа «<strong>Дата и время</strong>» экспортируется в документ Word как текст.</p>
<p>Для экспорта в шаблон Excel необходимо в файле Excel настроить соответствующий тип ячейки.</p>
<p>Для экспорта значения атрибута типа «<strong>Дата и время</strong>» можно задать формат по стандарту ISO 8601, например:</p>
<ul>
<li>заменитель <code>{dateAttributeSystemName:dd.MM.yyyy}</code> будет экспортирован в формате <code>04.12.2024</code>.</li>
</ul>
<div class="notice notice-info">
<p class="admonition-title">Примечание</p>
<p>Аналогичным образом можно форматировать даты и время при использовании функций <code>FORMAT()</code> и <code>FORMATLOC()</code>, например:</p>
<pre><code>FORMAT("{0:dddd, dd MMMM yyyy 'г.'}",LIST($dateAttributeSystemName))</code></pre>
</div>
<h3 id="mcetoc_1hhha06mh1">Примеры форматирования дат и времени</h3>
<div class="table-responsive">
<table border="1" cellspacing="0" style="width: 100%; height: 741px;">
<tbody>
<tr style="height: 39px;">
<th style="width: 0px; height: 0px;"><strong>Формат</strong></th>
<th style="width: 0px; height: 0px;"><strong>Результат</strong></th>
</tr>
<tr style="height: 39px;">
<td style="height: 0px; width: 100px;"><code>dd.MM.yyyy</code></td>
<td style="width: 0px; height: 0px;">29.05.2024</td>
</tr>
<tr style="height: 39px;">
<td style="height: 0px; width: 100px;"><code>dddd, dd MMMM yyyy 'г.'</code></td>
<td style="width: 0px; height: 0px;">среда, 29 мая 2024 г.</td>
</tr>
<tr style="height: 39px;">
<td style="height: 0px; width: 100px;"><code>dddd, dd MMMM yyyy HH:mm:ss</code></td>
<td style="width: 0px; height: 0px;">среда, 29 мая 2024 05:50:06</td>
</tr>
<tr style="height: 39px;">
<td style="height: 0px; width: 100px;"><code>dd.MM.yyyy HH:mm</code></td>
<td style="width: 0px; height: 0px;">29.05.2024 17:50</td>
</tr>
<tr style="height: 39px;">
<td style="height: 0px; width: 100px;"><code>dd.MM.yyyy hh:mm tt</code></td>
<td style="width: 0px; height: 0px;">29.05.2024 05:50 ПП <br/>29.05.2024 05:50 ДП</td>
</tr>
<tr style="height: 39px;">
<td style="height: 0px; width: 100px;"><code>dd.MM.yyyy H:mm</code></td>
<td style="width: 0px; height: 0px;">29.05.2024 5:50 <br/>29.05.2024 17:50</td>
</tr>
<tr style="height: 39px;">
<td style="height: 0px; width: 100px;"><code>dd.MM.yyyy h:mm tt</code></td>
<td style="width: 0px; height: 0px;">29.05.2024 5:50 ПП</td>
</tr>
<tr style="height: 39px;">
<td style="height: 0px; width: 100px;"><code>dd.MM.yyyy HH:mm:ss</code></td>
<td style="width: 0px; height: 0px;">29.05.2024 05:50:06 <br/>29.05.2024 17:50:06</td>
</tr>
<tr style="height: 39px;">
<td style="height: 0px; width: 100px;"><code>dd MMMM</code></td>
<td style="width: 0px; height: 0px;">29 мая</td>
</tr>
<tr style="height: 39px;">
<td style="height: 0px; width: 100px;"><code>yyyy'-'MM'-'dd', 'HH':'mm':'ss.fffffffK</code></td>
<td style="width: 0px; height: 0px;">2024-05-16, 05:50:06.7199222-04:00</td>
</tr>
<tr style="height: 39px;">
<td style="height: 0px; width: 100px;"><code>ddd, dd MMM yyy HH':'mm':'ss 'GMT' K</code></td>
<td style="width: 0px; height: 0px;">ср, 16 май 2024 05:50:06 GMT +03:00</td>
</tr>
<tr style="height: 39px;">
<td style="height: 0px; width: 100px;"><code>'dd'.'MM'.'yyyy'T'HH':'mm':'ss</code></td>
<td style="width: 0px; height: 0px;">16.05.2024T05:50:06</td>
</tr>
<tr style="height: 39px;">
<td style="height: 0px; width: 100px;"><code>HH:mm</code></td>
<td style="width: 0px; height: 0px;">05:50</td>
</tr>
<tr style="height: 39px;">
<td style="height: 0px; width: 100px;"><code>hh:mm tt</code></td>
<td style="width: 0px; height: 0px;">05:50 ДП <br/>05:50 ПП</td>
</tr>
<tr style="height: 39px;">
<td style="height: 0px; width: 100px;"><code>H:mm</code></td>
<td style="width: 0px; height: 0px;">5:50</td>
</tr>
<tr style="height: 39px;">
<td style="height: 0px; width: 100px;"><code>h:mm tt</code></td>
<td style="width: 0px; height: 0px;">5:50 ДП <br/>5:50 ПП</td>
</tr>
<tr style="height: 39px;">
<td style="height: 0px; width: 100px;"><code>HH:mm:ss</code></td>
<td style="width: 0px; height: 0px;">05:50:06</td>
</tr>
<tr style="height: 39px;">
<td style="height: 0px; width: 100px;"><code>MMMM yyyy 'г.'</code></td>
<td style="width: 0px; height: 0px;">май 2024 г.</td>
</tr>
</tbody>
</table>
</div>
<h3 id="mcetoc_1hhha0vfg2">Символы форматирования</h3>
<div class="table-responsive">
<table border="1" style="border-collapse: collapse; width: 100%; height: 1995px;">
<tbody>
<tr style="height: 39px;">
<th style="width: 0px; height: 0px;"><strong>Символ</strong></th>
<th style="width: 0px; height: 0px;"><strong>Описание</strong></th>
</tr>
<tr style="height: 121px;">
<td style="height: 0px; width: 5%;">
<p><code><span style="font-size: 15px; letter-spacing: 0.2px;">' '</span></code></p>
</td>
<td style="width: 0px; height: 0px;">
<p>В одинарные кавычки следует заключать символы, которые могут быть интерпретированы некорректно. Например, сочетание GMT без одинарных кавычек будет интерпретировано как G, номер месяца и T, так как буква M означает номер месяца.</p>
</td>
</tr>
<tr style="height: 71px;">
<td style="height: 0px; width: 5%;"><code><span style="font-size: 15px; letter-spacing: 0.2px;">d</span></code></td>
<td style="width: 0px; height: 0px;">
<p>Число месяца без ведущего нуля (1–31).</p>
</td>
</tr>
<tr style="height: 71px;">
<td style="height: 0px; width: 5%;"><code><span style="font-size: 15px; letter-spacing: 0.2px;">dd</span></code></td>
<td style="width: 0px; height: 0px;">
<p>Число месяца с ведущим нулём (01–31).</p>
</td>
</tr>
<tr style="height: 71px;">
<td style="height: 0px; width: 5%;"><code><span style="font-size: 15px; letter-spacing: 0.2px;">ddd</span></code></td>
<td style="width: 0px; height: 0px;">
<p>Сокращенное название дня недели со строчной буквы (пн, вт, ср, чт, пт, сб, вс).</p>
</td>
</tr>
<tr style="height: 71px;">
<td style="height: 0px; width: 5%;"><code><span style="font-size: 15px; letter-spacing: 0.2px;">dddd</span></code></td>
<td style="width: 0px; height: 0px;">
<p>Полное название дня недели со строчной буквы (понедельник – воскресенье).</p>
</td>
</tr>
<tr style="height: 71px;">
<td style="height: 0px; width: 5%;"><code><span style="font-size: 15px; letter-spacing: 0.2px;">h</span></code></td>
<td style="width: 0px; height: 0px;">
<p>Час в 12-часовом формате без ведущего нуля (например, 4).</p>
</td>
</tr>
<tr style="height: 71px;">
<td style="height: 0px; width: 5%;"><code><span style="font-size: 15px; letter-spacing: 0.2px;">hh</span></code></td>
<td style="width: 0px; height: 0px;">
<p>Час в 12-часовом формате с ведущим нулём (например, 04).</p>
</td>
</tr>
<tr style="height: 71px;">
<td style="height: 0px; width: 5%;"><code><span style="font-size: 15px; letter-spacing: 0.2px;">H</span></code></td>
<td style="width: 0px; height: 0px;">
<p>Час в 24-часовом формате без ведущего нуля (например, 4).</p>
</td>
</tr>
<tr style="height: 71px;">
<td style="height: 0px; width: 5%;"><code><span style="font-size: 15px; letter-spacing: 0.2px;">HH</span></code></td>
<td style="width: 0px; height: 0px;">
<p>Час в 24-часовом формате формат с ведущим нулём (например, 16).</p>
</td>
</tr>
<tr style="height: 71px;">
<td style="height: 0px; width: 5%;"><code><span style="font-size: 15px; letter-spacing: 0.2px;">m</span></code></td>
<td style="width: 0px; height: 0px;">
<p>Минуты, без ведущего нуля (0–59).</p>
</td>
</tr>
<tr style="height: 71px;">
<td style="height: 0px; width: 5%;"><code><span style="font-size: 15px; letter-spacing: 0.2px;">mm</span></code></td>
<td style="width: 0px; height: 0px;">
<p>Минуты с ведущим нулём (00–59).</p>
</td>
</tr>
<tr style="height: 39px;">
<td style="height: 0px; width: 5%;"><code><span style="font-size: 15px; letter-spacing: 0.2px;">M</span><span style="font-size: 15px; letter-spacing: 0.2px;"><br/></span></code></td>
<td style="width: 0px; height: 0px;">
<p>Номер месяца без ведущего нуля (1–12).</p>
</td>
</tr>
<tr style="height: 39px;">
<td style="height: 0px; width: 5%;">
<p><code>MM</code></p>
</td>
<td style="width: 0px; height: 0px;">Номер месяца с ведущим нулём (01–12).</td>
</tr>
<tr style="height: 39px;">
<td style="height: 0px; width: 5%;">
<p><code>MMM</code></p>
</td>
<td style="width: 0px; height: 0px;">Сокращенное название месяца без склонения со строчной буквы (янв., февр., март, апр., май, июнь, июль, авг., сент., окт., нояб., дек.).</td>
</tr>
<tr style="height: 39px;">
<td style="height: 0px; width: 5%;">
<p><code>MMMM</code></p>
</td>
<td style="width: 0px; height: 0px;">Полное название месяца со склонением со строчной буквы (например, января – декабря).</td>
</tr>
<tr style="height: 55px;">
<td style="height: 0px; width: 5%;">
<p><code>c</code></p>
</td>
<td style="width: 0px; height: 0px;">Секунды без ведущего нуля (0–59).</td>
</tr>
<tr style="height: 81px;">
<td style="height: 0px; width: 5%;">
<p><code>cc</code></p>
</td>
<td style="width: 0px; height: 0px;">Секунды с ведущим нулём (00–59).</td>
</tr>
<tr style="height: 81px;">
<td style="height: 0px; width: 5%;">
<p><code>t</code></p>
</td>
<td style="width: 0px; height: 0px;">Сокращенное обозначение «До полудня» или «После полудня» (Д или П).</td>
</tr>
<tr style="height: 55px;">
<td style="height: 0px; width: 5%;">
<p><code>tt</code></p>
</td>
<td style="width: 0px; height: 0px;">Полное обозначение «До полудня» или «После полудня» (ДП или ПП).</td>
</tr>
<tr style="height: 39px;">
<td style="height: 0px; width: 5%;">
<p><code>y</code></p>
</td>
<td style="width: 0px; height: 0px;">Год без ведущего нуля (например, 2004 будет выведен как 4).</td>
</tr>
<tr style="height: 39px;">
<td style="height: 0px; width: 5%;">
<p><code>yy</code></p>
</td>
<td style="width: 0px; height: 0px;">Год с ведущим нулём (например, 2004 год будет выведен как 04).</td>
</tr>
<tr style="height: 39px;">
<td style="height: 0px; width: 5%;"><code><span style="font-size: 15px; letter-spacing: 0.2px;"> </span></code>
<p><code>yyy</code></p>
</td>
<td style="width: 0px; height: 0px;">Год (например, 2024).</td>
</tr>
<tr style="height: 39px;">
<td style="height: 0px; width: 5%;">
<p><code>yyyy</code></p>
</td>
<td style="width: 0px; height: 0px;">Год (например, 2024).</td>
</tr>
<tr style="height: 39px;">
<td style="height: 0px; width: 5%;">
<p><code>K</code></p>
</td>
<td style="width: 0px; height: 0px;">Часовой пояс значения даты и времени (например, +05:00).</td>
</tr>
<tr style="height: 39px;">
<td style="height: 0px; width: 5%;">
<p><code>z</code></p>
</td>
<td style="width: 0px; height: 0px;">Отрицательное или положительное смещение часового пояса локальной операционной системы от UTC в часах (например, +6).</td>
</tr>
<tr style="height: 39px;">
<td style="height: 0px; width: 5%;">
<p><code>zz</code></p>
</td>
<td style="width: 0px; height: 0px;">То же самое, что<span style="font-size: 15px; letter-spacing: 0.2px;"> </span><code><span style="font-size: 15px; letter-spacing: 0.2px;">z</span></code> <span style="font-size: 15px; letter-spacing: 0.2px;"> , но с ведущим нулём (например, +06). </span></td>
</tr>
<tr style="height: 39px;">
<td style="height: 0px; width: 5%;"><code><span style="font-size: 15px; letter-spacing: 0.2px;"> </span></code>
<p><code>zzz</code></p>
</td>
<td style="width: 0px; height: 0px;">Отрицательное или положительное смещение часового пояса локальной операционной системы от UTC в часах и минутах (например, +06:00).</td>
</tr>
<tr style="height: 55px;">
<td style="height: 0px; width: 5%;">
<p><code>f</code></p>
</td>
<td style="width: 0px; height: 0px;">Десятые доли секунды.</td>
</tr>
<tr style="height: 55px;">
<td style="height: 0px; width: 5%;">
<p><code>ff</code></p>
</td>
<td style="width: 0px; height: 0px;">Сотые доли секунды.</td>
</tr>
<tr style="height: 55px;">
<td style="height: 0px; width: 5%;">
<p><code>fff</code></p>
</td>
<td style="width: 0px; height: 0px;">Миллисекунды.</td>
</tr>
<tr style="height: 55px;">
<td style="height: 0px; width: 5%;">
<p><code>ffff</code></p>
</td>
<td style="width: 0px; height: 0px;">Десятитысячные доли секунды.</td>
</tr>
<tr style="height: 55px;">
<td style="height: 0px; width: 5%;">
<p><code>fffff</code></p>
</td>
<td style="width: 0px; height: 0px;">Стотысячные доли секунды.</td>
</tr>
<tr style="height: 55px;">
<td style="height: 0px; width: 5%;">
<p><code>ffffff</code></p>
</td>
<td style="width: 0px; height: 0px;">Миллионные доли секунды.</td>
</tr>
<tr style="height: 55px;">
<td style="height: 0px; width: 5%;">
<p><code>fffffff</code></p>
</td>
<td style="width: 0px; height: 0px;">Десятимиллионные доли секунды.</td>
</tr>
</tbody>
</table>
</div>
<h2 id="mcetoc_1hhh1k4kd3">Форматирование значений длительности</h2>
<p>Значение атрибута типа «<strong>Длительность</strong>» экспортируется в документ Word как текст.</p>
<p>Для экспорта в шаблон Excel без потери формата необходимо в файле Excel настроить соответствующий тип ячейки.</p>
<p>Для экспорта значения атрибута типа «<strong>Дата и время</strong>» можно задать формат по стандарту ISO 8601, например:</p>
<ul>
<li>заменитель <code>{durationAttributeSystemName:dd' д 'hh' ч'}</code> будет экспортирован в формате <code>1 д 3 ч</code>.</li>
</ul>
<div class="notice notice-info">
<p class="admonition-title">Примечание</p>
<p>Аналогичным образом можно форматировать даты и время при использовании функций <code>FORMAT()</code> и <code>FORMATLOC()</code>, например:</p>
<pre><code>FORMAT("{0:dd' д. 'hh':'mm':'ss}",LIST($durationAttributeSystemName))</code></pre>
</div>
<h3 id="mcetoc_1hhhac5793">Примеры форматирования значений длительности</h3>
<div class="table-responsive">
<table border="1" cellspacing="0" style="height: 0px; width: 100%;">
<tbody>
<tr style="height: 39px;">
<th style="width: 0px; height: 0px;"><strong>Формат</strong></th>
<th style="width: 0px; height: 0px;"><strong>Результат</strong></th>
</tr>
<tr style="height: 39px;">
<td style="height: 0px; width: 26.3789%;"><code>c</code></td>
<td style="width: 0px; height: 0px;">1.23:01:01 <br/>01:01:01 <br/>-23:59:59</td>
</tr>
<tr style="height: 39px;">
<td style="height: 0px; width: 26.3789%;"><code>g</code></td>
<td style="width: 0px; height: 0px;">
<p>1.23:01:01</p>
<p>1.23:01:01,000</p>
</td>
</tr>
<tr style="height: 39px;">
<td style="height: 0px; width: 26.3789%;"><code>G</code></td>
<td style="width: 0px; height: 0px;">1:23:01:59,0000000</td>
</tr>
<tr>
<td style="height: 0px; width: 26.3789%;"><code>dd' д. 'hh':'mm':'ss</code></td>
<td style="width: 0px; height: 0px;">01 д. 03:01:01</td>
</tr>
<tr>
<td style="width: 26.3789%;"><code>d' д 'hh' ч 'mm' м 'ss 'c'</code></td>
<td style="width: 0px; height: 0px;">1 д 03 ч 01 м 01 с</td>
</tr>
<tr>
<td style="width: 26.3789%;"><code>d' д 'h' ч '</code></td>
<td style="width: 0px; height: 0px;">1 д 3 ч</td>
</tr>
</tbody>
</table>
</div>
<h3 id="mcetoc_1hhh9f21g0">Символы форматирования</h3>
<div class="table-responsive">
<table border="1" cellspacing="0" style="height: 441px; width: 100%;">
<tbody>
<tr style="height: 39px;">
<th style="width: 0px; height: 0px;"><strong>Элемент</strong></th>
<th style="width: 0px; height: 0px;"><strong>Описание</strong></th>
</tr>
<tr>
<td style="height: 0px; width: 5%;"><code>с</code></td>
<td style="width: 0px; height: 0px;">[-][d.]hh:mm:ss[.fffffff] — унифицированный формат без локализации, необязательные дни и доли секунды, формат по умолчанию.</td>
</tr>
<tr>
<td style="height: 0px; width: 5%;"><code>g</code></td>
<td style="width: 0px; height: 0px;"><span style="font-size: 15px; letter-spacing: 0.2px;">[-][d:]h:mm:ss[.FFFFFFF] — короткий формат, необязательные дни и доли секунды, разделитель долей секунды локализуется.</span></td>
</tr>
<tr>
<td style="height: 0px; width: 5%;"><code>G</code></td>
<td style="width: 0px; height: 0px;"><span style="font-size: 15px; letter-spacing: 0.2px;">[-]d:hh:mm:ss.fffffff — длинный формат, всегда включает дни и доли секунды, разделитель долей секунды локализуется.</span></td>
</tr>
<tr style="height: 39px;">
<td style="height: 0px; width: 5%;"><code>-</code></td>
<td style="width: 0px; height: 0px;">Необязательный отрицательный знак, обозначающий отрицательный интервал времени.</td>
</tr>
<tr>
<td style="width: 5%;"><code>' '</code></td>
<td style="width: 0px;">В одинарные кавычки следует заключать символы, которые могут быть интерпретированы некорректно. Например, двоеточие необходимо заключать в одинарные кавычки, иначе значение  длительности не будет выведено, а символ m без одинарных кавычек будет интерпретирован количество минут.</td>
</tr>
<tr style="height: 39px;">
<td style="height: 0px; width: 5%;"><code>d</code></td>
<td style="width: 0px; height: 0px;">Дни без ведущего нуля.</td>
</tr>
<tr>
<td style="width: 5%;"><code>dd</code></td>
<td style="width: 0px;">Дни с ведущим нулём.</td>
</tr>
<tr style="height: 39px;">
<td style="height: 0px; width: 5%;"><code>h</code></td>
<td style="width: 0px; height: 0px;">Часы без ведущего нуля, 00–23.</td>
</tr>
<tr style="height: 39px;">
<td style="height: 0px; width: 5%;"><code>hh</code></td>
<td style="width: 0px; height: 0px;">Часы с ведущим нулём, 0–23.</td>
</tr>
<tr style="height: 39px;">
<td style="height: 0px; width: 5%;"><code>m</code></td>
<td style="width: 0px; height: 0px;">Минуты без ведущего нуля, 0–59.</td>
</tr>
<tr>
<td style="height: 0px; width: 5%;"><code>mm</code></td>
<td style="width: 0px; height: 0px;">Минуты с ведущим нулём, 00–59.</td>
</tr>
<tr style="height: 39px;">
<td style="height: 0px; width: 5%;"><code>ss</code></td>
<td style="width: 0px; height: 0px;">Секунды без ведущего нуля, 0–59.</td>
</tr>
<tr>
<td style="height: 0px; width: 5%;"><code>ss</code></td>
<td style="width: 0px; height: 0px;">Секунды в диапазоне 00–59.</td>
</tr>
<tr style="height: 40px;">
<td style="height: 0px; width: 5%;"><code>fffffff</code></td>
<td style="width: 0px; height: 0px;">Доли секунды в диапазоне 0000001–9999999.</td>
</tr>
<tr style="height: 64px;">
<td style="height: 0px; width: 5%;"><code>FFFFFFF</code></td>
<td style="width: 0px; height: 0px;">Доли секунды в диапазоне 0000001–9999999, выводится минимально возможное количество цифр.</td>
</tr>
</tbody>
</table>
</div>
<h2 id="mcetoc_1hhh1kfe44">Форматирование логических значений</h2>
<p>Значение атрибута типа «<strong>Логический</strong>» экспортируется как строка «<em>Истина» </em>или <em>«Ложь</em>».</p>
<p>Для экспорта значения в другом виде (например, <code>"Согласовано","Не согласовано"</code>) можно привести его к требуемому формату. Для этого создайте новый текстовый атрибут и сделайте его вычисляемым с помощью формулы, например:</p>
<pre><code>FORMAT("{0}",LIST(IF($attributeSystemName == true,"Согласовано","Не согласовано")))</code></pre>
<h2 id="mcetoc_1hhh1u2qs5">Форматирование данных аккаунта</h2>
<p>Посредством атрибута типа «<strong>Аккаунт</strong>» можно экспортировать данные пользователя (значения атрибутов аккаунта), например, адрес эл. почты и должность.</p>
<p>При этом можно форматировать значения атрибутов. Например:</p>
<ul>
<li><code>{accountAttributeSystemName.birthday:dd MMMM yyyy 'г.'}</code> — дата рождения в формате: <em>29 мая 2024 г.</em>;</li>
<li><code>{accountAttributeSystemName.title}</code> — должность.</li>
</ul>
<p>См. также <a href="https://kb.comindware.ru/article.php?id=1354">полный перечень атрибутов аккаунта</a>.</p>
<h2 id="mcetoc_1hhh23qoc6">Форматирование атрибутов связанных записей</h2>
<p>Атрибут типа «<strong>Запись</strong>» можно экспортировать атрибуты связанных записей, указывая атрибут связанного шаблона через точку после системного имени атрибута типа «<strong>Запись</strong>».</p>
<p>При этом можно форматировать значения атрибутов. Например:</p>
<ul>
<li><code>{recordAttributeSystemName.Date:dd.MM.yyyy}</code> — дата в записи, связанной с текущей записью, в формате:<em> 05.12.2024</em>;</li>
<li><code>{recordAttributeSystemName.Dogovor.Summa:N2}</code> — сумма договора в записи, связанной с текущей записью, в формате <em>десятичного числа с двумя знаками</em>.</li>
</ul>
<div class="notice notice-info">
<p class="admonition-title">Примечание</p>
<p>Для формирования гиперссылки на запись перед системным атрибута типа «<strong>Запись</strong>» символ <code>#</code>, например, <code>{#recordAttributeSystemName}</code>.</p>
</div>
<h2 id="mcetoc_1hhh24one7">Форматирование значений при экспорте коллекции записей</h2>
<p>Для атрибута типа «<strong>Запись</strong>» с несколькими значениями (коллекции) можно экспортировать как столбцы коллекции, так и значения атрибутов связанных шаблонов.</p>
<p>При этом можно форматировать значения атрибутов.</p>
<h3 id="mcetoc_1hhhtg5pr1">Пример таблицы для экспорта коллекции</h3>
<table style="height: 0px; width: 100%;">
<tbody>
<tr>
<td style="width: 0px; height: 0px;"><code>{foreach:Collection}{Date:dd.MM.yyyy}</code></td>
<td style="width: 0px; height: 0px;"><code>{Type.Name}</code></td>
<td style="width: 0px; height: 0px;"><code>{Quantity:N1}</code></td>
<td style="width: 0px; height: 0px;"><code>{Sum:N2}{end:Collection}</code></td>
</tr>
</tbody>
</table>
<h3 id="mcetoc_1hhh3li6fa">Синтаксис экспорта атрибутов коллекции<code></code><code></code></h3>
<ul>
<li><code>{foreach:Collection}</code>
<ul>
<li><code>foreach</code> — объявление начала цикла по коллекции записей в первом столбце строки.</li>
<li><code>Collection</code> — системное имя атрибута типа «<strong>Запись</strong>» с несколькими значениями.</li>
</ul>
</li>
<li><code>Name</code>, <code>Quantity</code>, <code>Sum</code> — системные имена атрибутов шаблона записи, на который ссылается атрибут <code style="letter-spacing: 0.2px;">Collection:</code>
<ul>
<li><code>Date:dddd, dd.MM.yyyy</code> — значение атрибута типа «<strong>Дата</strong>» в формате: <em>вторник, 05.12.2024</em>.</li>
<li><code></code><code></code><code>Quantity:N0</code> — <em>целочисленное</em> значение атрибута типа «<strong>Число</strong>».</li>
<li><code>Sum:N2</code> — десятичное значение атрибута типа «<strong style="letter-spacing: 0.2px;">Число</strong><span style="letter-spacing: 0.2px;">»<em> с двумя знаками после запятой</em>.</span></li>
</ul>
</li>
<li><code>Type.Name</code>
<ul>
<li><code>Type</code> — системное имя атрибута типа «<strong>Запись</strong>», который ссылается на шаблон <em>«Тип».</em></li>
<li><code>Name</code> — системное имя атрибута <em>«Название»</em> типа «<strong>Текст</strong>» в шаблоне <em>«Тип».</em></li>
</ul>
</li>
<li><code>{end:Collection}</code> <code></code>— конец цикла по коллекции записей в последнем столбце строки.</li>
</ul>
<h2 id="mcetoc_1hhh2m6ns8">Связанные статьи</h2>
<p><strong><samp data-name="aid" data-title="" data-value="2599"><span style="color: #0066bc; font-family: Tahoma;"><img src="https://kb.comindware.ru/images/marker.png" style="vertical-align: middle;"/>Системные имена атрибутов аккаунтов {Article-ID:2599}</span></samp> </strong></p>
<p><strong><samp data-name="aid" data-title="" data-value="2352"><span style="color: #0066bc; font-family: Tahoma;"><img src="https://kb.comindware.ru/images/marker.png" style="vertical-align: middle;"/>Подготовка файла шаблона экспорта {Article-ID:2352}</span></samp> </strong></p>
<p><strong><samp data-name="aid" data-title="" data-value="2492"><span style="color: #0066bc; font-family: Tahoma;"><img src="https://kb.comindware.ru/images/marker.png" style="vertical-align: middle;"/>Список функций языка формул Comindware {Article-ID:2492}</span></samp> </strong></p>
<p><a class="md-top md-icon mkdocs_imported_link" href="#"> <em class="fa-light fa-arrow-up">‌</em> К началу </a></p>